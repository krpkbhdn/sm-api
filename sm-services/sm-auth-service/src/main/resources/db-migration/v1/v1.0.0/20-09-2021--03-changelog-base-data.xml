<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.3.xsd">

    <changeSet id="20-09-2021--03-changelog--01-add-client" author="Bohdan Krupko">
        <insert tableName="oauth_client_details">
            <column name="client_id" value="web-app" />
            <column name="client_secret" value="$2a$10$ByD2GiX9IQp7q3KJ3/6fg.mEh9N62bPuZoIdPr1jcwBxtef48l8qe" />
            <column name="resource_ids" value="all" />
            <column name="scope" value="READ,WRITE" />
            <column name="authorized_grant_types" value="authorization_code,password,refresh_token,implicit" />
            <column name="web_server_redirect_uri" value="http://localhost:3200" />
            <column name="access_token_validity" value="7200" />
            <column name="refresh_token_validity" value="14800" />
            <column name="additional_information" value="{}" />
        </insert>
        <rollback>
            <delete tableName="oauth_client_details">
                <where>client_id='web-app'</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="20-09-2021--03-changelog--02-add-roles" author="Bohdan Krupko">
        <insert tableName="role">
            <column name="id" value="1"/>
            <column name="name" value="ROLE_SUPER_ADMIN"/>
        </insert>
        <insert tableName="role">
            <column name="id" value="2"/>
            <column name="name" value="ROLE_ADMIN"/>
        </insert>
        <insert tableName="role">
            <column name="id" value="3"/>
            <column name="name" value="ROLE_MANAGER"/>
        </insert>
        <insert tableName="role">
            <column name="id" value="4"/>
            <column name="name" value="ROLE_USER"/>
        </insert>
        <rollback>
            <delete tableName="role">
                <where>id in (1, 2, 3, 4)</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="20-09-2021--03-changelog--03-add-permission" author="Bohdan Krupko">
        <insert tableName="permission">
            <column name="id" value="1"/>
            <column name="name" value="CREATE_MENU"/>
        </insert>
        <insert tableName="permission">
            <column name="id" value="2"/>
            <column name="name" value="UPDATE_MENU"/>
        </insert>
        <insert tableName="permission">
            <column name="id" value="3"/>
            <column name="name" value="READ_MENU"/>
        </insert>
        <insert tableName="permission">
            <column name="id" value="4"/>
            <column name="name" value="DELETE_MENU"/>
        </insert>
        <rollback>
            <delete tableName="permission">
                <where>id in (1, 2, 3, 4)</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="20-09-2021--03-changelog--04-relation-role_permission" author="Bohdan Krupko">
        <insert tableName="role_permission">
            <column name="role_id" value="1"/>
            <column name="permission_id" value="1"/>
        </insert>
        <insert tableName="role_permission">
            <column name="role_id" value="1"/>
            <column name="permission_id" value="2"/>
        </insert>
        <insert tableName="role_permission">
            <column name="role_id" value="1"/>
            <column name="permission_id" value="3"/>
        </insert>
        <insert tableName="role_permission">
            <column name="role_id" value="1"/>
            <column name="permission_id" value="4"/>
        </insert>

        <insert tableName="role_permission">
            <column name="role_id" value="2"/>
            <column name="permission_id" value="1"/>
        </insert>
        <insert tableName="role_permission">
            <column name="role_id" value="2"/>
            <column name="permission_id" value="2"/>
        </insert>
        <insert tableName="role_permission">
            <column name="role_id" value="2"/>
            <column name="permission_id" value="3"/>
        </insert>

        <rollback>
            <delete tableName="role_permission">
                <where>(role_id,permission_id) in ((1,1),(1,2),(1,3),(1,4),(2,1),(2,2),(2,3))</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="20-09-2021--03-changelog--05-add-user" author="Bohdan Krupko">
        <insert tableName="sm_user">
            <column name="id" value="1"/>
            <column name="username" value="super-admin"/>
            <column name="password" value="$2a$10$ByD2GiX9IQp7q3KJ3/6fg.mEh9N62bPuZoIdPr1jcwBxtef48l8qe"/>
            <column name="account_non_expired" value="true"/>
            <column name="account_non_locked" value="true"/>
            <column name="credentials_non_expired" value="true"/>
            <column name="enabled" value="true"/>
        </insert>
        <insert tableName="sm_user">
            <column name="id" value="2"/>
            <column name="username" value="admin"/>
            <column name="password" value="$2a$10$ByD2GiX9IQp7q3KJ3/6fg.mEh9N62bPuZoIdPr1jcwBxtef48l8qe"/>
            <column name="account_non_expired" value="true"/>
            <column name="account_non_locked" value="true"/>
            <column name="credentials_non_expired" value="true"/>
            <column name="enabled" value="true"/>
        </insert>
        <rollback>
            <delete tableName="sm_user">
                <where>id in (1, 2)</where>
            </delete>
        </rollback>
    </changeSet>

    <changeSet id="20-09-2021--03-changelog--06-relation-user_role" author="Bohdan Krupko">
        <insert tableName="user_role">
            <column name="user_id" value="1"/>
            <column name="role_id" value="1"/>
        </insert>
        <insert tableName="user_role">
            <column name="user_id" value="2"/>
            <column name="role_id" value="2"/>
        </insert>

        <rollback>
            <delete tableName="role_permission">
                <where>(role_id,permission_id) in ((1,1),(2,2))</where>
            </delete>
        </rollback>
    </changeSet>


</databaseChangeLog>
